---
title: "Go IP_BIND_ADDRESS_NO_PORT"
date: 2019-10-26T22:53:59+03:00
draft: true
tags:
- golang
- go
slug: go-ip-bind-address-no-port
aliases: [go-ip-bind-address-no-port]
---

Как мы знаем в линуксе можно создать не более 65 тысяч коннектов одновременно
Из-за чего данное ограничение? Исходящие порты могут просто закончатся, особенно когда создаётся много исходящих соединений.
Диапазон так называемых эфермерных портов ограничен и по дефолту: net.ipv4.ip_local_port_range = 32768 61000
Т.е. всего около 28к исходящих портов, да можно потюнить, но всё равно будем ограничены размером порта, а это 16 бит.

Потому что ядро не знает будет ли этот сокет использован для вызова listen()



Начиная с ядра 4.2 появилась опция для сокета IP_BIND_ADDRESS_NO_PORT

В ядре коннект должен содержать уникальные значения
src_ip, src_port, dst_ip, dst_port
<!--more-->
